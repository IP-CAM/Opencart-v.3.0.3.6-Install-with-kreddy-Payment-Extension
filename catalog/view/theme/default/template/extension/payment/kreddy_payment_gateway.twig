<form action="https://kupisega.mk/?wc-api=WC_Gateway_Kreddy" method="post">
    <h3>{{ heading_title }}</h3>
    <div id="kreddycalculator">
        <div class="header-loan-amount">
            <h2>Износ на кошничка: <span>{{ total }}</span></h2>
        </div>
        <div class="body-loan-number-of-installments">
            <h2>Изберете период на отплата <span><strong id="installments-number">3</strong> месеци</span></h2>
        </div>
        <div class="slidecontainer body-loan-range-slider">
            <input type="range" name="installments" min="3" max="24" value="10" class="slider" id="myRange">
        </div>
        <div class="body-input-embg txtinput">
            <input type="text" name="clientEmbg" id="clientEMBGinput" placeholder="Внесете го вашиот ЕМБГ">
        </div>
        <div class="body-input-personal-id-document-no">
            <select name="clientDocType" id="clientDocType">
                <option value="0">Лична карта</option>
                <option value="1">Пасош</option>
            </select>
            <input type="text" name="clientDocNumber" id="clientDocNumber" placeholder="Број на Лична карта - Пасош">
        </div>
        <input id="agreement-check" type="checkbox" name="kreddy-agreement"> Се согласувам со <a href="https://kupisega.mk/wp-content/plugins/kreddypaymentgateway/assets/PersonalDataDeclarationMK.pdf" target="_blank">условите</a>

        {# FOREACH #}
        <input id="step3data" type="text" name="step3" class="hidden" value="" hidden="">
        <input id="step4data" type="text" name="step4" class="hidden" value="" hidden="">
        <input id="step5data" type="text" name="step5" class="hidden" value="" hidden="">
        <input id="step6data" type="text" name="step6" class="hidden" value="" hidden="">
        <input id="step7data" type="text" name="step7" class="hidden" value="" hidden="">
        <input id="step8data" type="text" name="step8" class="hidden" value="" hidden="">
        <input id="step9data" type="text" name="step9" class="hidden" value="" hidden="">
        <input id="step10data" type="text" name="step10" class="hidden" value="" hidden="">
        <input id="step11data" type="text" name="step11" class="hidden" value="" hidden="">
        <input id="step12data" type="text" name="step12" class="hidden" value="" hidden="">
        <input id="step13data" type="text" name="step13" class="hidden" value="" hidden="">
        <input id="step14data" type="text" name="step14" class="hidden" value="" hidden="">
        <input id="step15data" type="text" name="step15" class="hidden" value="" hidden="">
        <input id="step16data" type="text" name="step16" class="hidden" value="" hidden="">
        <input id="step17data" type="text" name="step17" class="hidden" value="" hidden="">
        <input id="step18data" type="text" name="step18" class="hidden" value="" hidden="">
        <input id="step19data" type="text" name="step19" class="hidden" value="" hidden="">
        <input id="step20data" type="text" name="step20" class="hidden" value="" hidden="">
        <input id="step21data" type="text" name="step21" class="hidden" value="" hidden="">
        <input id="step22data" type="text" name="step22" class="hidden" value="" hidden="">
        <input id="step23data" type="text" name="step23" class="hidden" value="" hidden="">
        <input id="step24data" type="text" name="step24" class="hidden" value="" hidden="">

        <!-- order info fields -->
        <input type="text" name="kreddyOrderNumber" class="hidden" value="8293" hidden="">
        <input type="text" name="KreddyApplicationStatus" class="hidden" value="1" hidden="">
        <input type="text" name="clientFirstName" id="clientFirstName" class="hidden" value="Test" hidden="">
        <input type="text" name="clientLastName" id="clientLastName" class="hidden" value="Testerski" hidden="">
        <input type="text" name="clientTelephone" id="clientTelephone" class="hidden" value="077777555" hidden="">
        <input type="text" name="clientEmail" id="clientEmail" class="hidden" value="email@gmail.com" hidden="">
        
        <!-- Loan info fields -->
        <input type="text" name="loanAPR" id="loanAPR" class="hidden" value="51.12" hidden="">
        <input type="text" name="loanAPRamount" id="loanAPRamount" class="hidden" value="852" hidden="">
        <input type="text" name="loanAMTP" id="loanAMTP" class="hidden" value="10852" hidden="">
        <input type="text" name="loanFeeAmount" id="loanFeeAmount" class="hidden" value="3617" hidden="">
        <input type="text" name="loanDueDate" id="loanDueDate" class="hidden" value="20202020" hidden="">

        <div id="apply-for-loan-btn" class="kreddy-submit"><input type="submit" value="Аплицирај сега!"></div>
    </div>

    <div id="kreddycalculatorresults">
        <ul>
            <li>Вкупно провизиjа (CBT <strong id="info-apr-percent">47.4 %</strong>) <span id="info-apr">1970 мкд</span></li>
            <li>Вкупен износ за отплата <span id="info-amount-to-pay">26969 мкд</span></li>
            <li>Датум на отплата <span id="info-due-date">21/12/2020</span></li>
            <li>Број на рати <span><strong id="installments-number2">3</strong> рати</span></li>
            <!-- <li>Износ на рата без гарант <span>4322 ден</span></li> -->
            <li>Износ на ратa <span id="info-fee-amount">8990 мкд</span></li>
        </ul>
    </div>

</form>

<script>
    var applyBtn = document.getElementById("apply-for-loan-btn");
    var agreementCheck = document.getElementById("agreement-check");

    var loanAPR = document.getElementById("loanAPR");
    var loanAPRamount = document.getElementById("loanAPRamount");
    var loanAMTP = document.getElementById("loanAMTP");
    var loanFeeAmount = document.getElementById("loanFeeAmount");
    var loanDueDate = document.getElementById("loanDueDate");


    var slider = document.getElementById("myRange");
    var output = document.getElementById("installments-number");
    var output2 = document.getElementById("installments-number2");

    var infoAprPercent = document.getElementById("info-apr-percent");
    var infoApr = document.getElementById("info-apr");
    var infoAmountToPay = document.getElementById("info-amount-to-pay");
    var infoDueDate = document.getElementById("info-due-date");
    var infoFeeAmount = document.getElementById("info-fee-amount");

    var step3 = document.getElementById("step3data");
    var step4 = document.getElementById("step4data");
    var step5 = document.getElementById("step5data");
    var step6 = document.getElementById("step6data");
    var step7 = document.getElementById("step7data");
    var step8 = document.getElementById("step8data");
    var step9 = document.getElementById("step9data");
    var step10 = document.getElementById("step10data");
    var step11 = document.getElementById("step11data");
    var step12 = document.getElementById("step12data");
    var step13 = document.getElementById("step13data");
    var step14 = document.getElementById("step14data");
    var step15 = document.getElementById("step15data");
    var step16 = document.getElementById("step16data");
    var step17 = document.getElementById("step17data");
    var step18 = document.getElementById("step18data");
    var step19 = document.getElementById("step19data");
    var step20 = document.getElementById("step20data");
    var step21 = document.getElementById("step21data");
    var step22 = document.getElementById("step22data");
    var step23 = document.getElementById("step23data");
    var step24 = document.getElementById("step24data");

    var step3value = jQuery.parseJSON(step3.value);
    var step4value = jQuery.parseJSON(step4.value);
    var step5value = jQuery.parseJSON(step5.value);
    var step6value = jQuery.parseJSON(step6.value);
    var step7value = jQuery.parseJSON(step7.value);
    var step8value = jQuery.parseJSON(step8.value);
    var step9value = jQuery.parseJSON(step9.value);
    var step10value = jQuery.parseJSON(step10.value);
    var step11value = jQuery.parseJSON(step11.value);
    var step12value = jQuery.parseJSON(step12.value);
    var step13value = jQuery.parseJSON(step13.value);
    var step14value = jQuery.parseJSON(step14.value);
    var step15value = jQuery.parseJSON(step15.value);
    var step16value = jQuery.parseJSON(step16.value);
    var step17value = jQuery.parseJSON(step17.value);
    var step18value = jQuery.parseJSON(step18.value);
    var step19value = jQuery.parseJSON(step19.value);
    var step20value = jQuery.parseJSON(step20.value);
    var step21value = jQuery.parseJSON(step21.value);
    var step22value = jQuery.parseJSON(step22.value);
    var step23value = jQuery.parseJSON(step23.value);
    var step24value = jQuery.parseJSON(step24.value);

    // var dueDate = moment(window['step' + slider.value + 'value'].due_date).format('DD/MM/YYYY');
    var dueDate = moment().add(slider.value, 'months').format('DD/MM/YYYY');
        
    output.innerHTML = slider.value;
    output2.innerHTML = slider.value;

    infoAprPercent.innerHTML = window['step' + slider.value + 'value'].apr + ' %'; 
    infoApr.innerHTML = window['step' + slider.value + 'value'].fee_amount + ' мкд';
    infoAmountToPay.innerHTML = window['step' + slider.value + 'value'].amount_to_pay + ' мкд';
    infoDueDate.innerHTML = dueDate;
    infoFeeAmount.innerHTML = window['step' + slider.value + 'value'].installment_payment + ' мкд';

    loanAPR.value = window['step' + slider.value + 'value'].apr + ' %';
    loanAPRamount.value = window['step' + slider.value + 'value'].fee_amount + ' мкд';
    loanAMTP.value = window['step' + slider.value + 'value'].amount_to_pay + ' мкд';
    loanFeeAmount.value = window['step' + slider.value + 'value'].installment_payment + ' мкд';
    loanDueDate.value = moment(window['step' + slider.value + 'value'].due_date).format('DD.MM.YYYY HH:mm:ss');

    slider.oninput = function() {
        output.innerHTML = this.value;
        output2.innerHTML = this.value;

        dueDate = moment().add(slider.value, 'months').format('DD/MM/YYYY');

        infoAprPercent.innerHTML = window['step' + this.value + 'value'].apr + ' %';
        infoApr.innerHTML = window['step' + this.value + 'value'].fee_amount + ' мкд';
        infoAmountToPay.innerHTML = window['step' + this.value + 'value'].amount_to_pay + ' мкд';
        infoDueDate.innerHTML = dueDate;
        infoFeeAmount.innerHTML = window['step' + this.value + 'value'].installment_payment + ' мкд';

        loanAPR.value = window['step' + this.value + 'value'].apr + ' %';
        loanAPRamount.value = window['step' + this.value + 'value'].fee_amount + ' мкд';
        loanAMTP.value = window['step' + this.value + 'value'].amount_to_pay + ' мкд';
        loanFeeAmount.value = window['step' + this.value + 'value'].installment_payment + ' мкд';
        loanDueDate.value = moment().add(slider.value, 'months').format('DD.MM.YYYY HH:mm:ss');
    }
</script>